      # 8A) PREVIEW 전용 — 댓글 본문 기준으로 강제 성공
      - name: Run KO via PS7 (preview-safe by body)
        if: ${{ contains(github.event.comment.body, '/ak fixloop') && contains(github.event.comment.body, 'preview') && !contains(github.event.comment.body, 'apply') }}
        shell: bash
        continue-on-error: true
        run: |
          set +e
          pwsh -NoLogo -NoProfile -File scripts/g5/ak-dispatch.ps1 \
            -Command '${{ steps.parse.outputs.cmd }}' \
            -RawArgs '${{ steps.parse.outputs.args }}' \
            -Sha '${{ github.sha }}' \
            -Pr '${{ github.event.issue.number || github.event.pull_request.number }}' \
            || true
          echo "[note] preview mode: forced success"
          echo -e "result=success\ncmd=/ak ${{ steps.parse.outputs.cmd }} ${{ steps.parse.outputs.args }}" >> "$GITHUB_STEP_SUMMARY"
          true

      # 8B) 그 외 전부 — <10→0 정규화, ≥10은 실패
      - name: Run KO via PS7 (strict)
        if: ${{ !( contains(github.event.comment.body, '/ak fixloop') && contains(github.event.comment.body, 'preview') && !contains(github.event.comment.body, 'apply') ) }}
        shell: bash
        run: |
          set +e
          pwsh -NoLogo -NoProfile -File scripts/g5/ak-dispatch.ps1 \
            -Command '${{ steps.parse.outputs.cmd }}' \
            -RawArgs '${{ steps.parse.outputs.args }}' \
            -Sha '${{ github.sha }}' \
            -Pr '${{ github.event.issue.number || github.event.pull_request.number }}'
          code=$?
          if [ -z "$code" ]; then code=0; fi
          if [ "$code" -lt 10 ]; then
            echo "[note] normalize exit code $code → 0 (non-fatal)"
            exit 0
          else
            exit "$code"
          fi